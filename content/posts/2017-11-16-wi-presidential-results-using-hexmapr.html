---
title: "Wisconsin State Hex Grid - Mapping 2016 Presidential Results"
author: ''
date: '2017-11-16'
categories: posts
tags:
- dataviz
- ggplot2
- hexmapr
- R
subtitle: ''
bigimg: [{src: "/img/wiHexPlot.png", desc: "Wisconsin Hex Plot of 2016 Presidential Results by County"}]
twitterimg: "https://www.mikelee.co/img/wiHexPlot.png"
---



<div id="neat-package-alert" class="section level2">
<h2>NEAT PACKAGE ALERT!</h2>
<blockquote class="twitter-tweet" data-lang="en">
<p lang="en" dir="ltr">
My 1st R package! <a href="https://t.co/dI3GJbC7FQ">https://t.co/dI3GJbC7FQ</a> Automatically turn geospatial polygons like states into regular/hexagonal grids <a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a> <a href="https://twitter.com/hashtag/ggplot2?src=hash&amp;ref_src=twsrc%5Etfw">#ggplot2</a> <a href="https://t.co/dxvYCZWJzU">pic.twitter.com/dxvYCZWJzU</a>
</p>
— J Bailey (<span class="citation">@iammrbailey</span>) <a href="https://twitter.com/iammrbailey/status/925346870381240320?ref_src=twsrc%5Etfw">October 31, 2017</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>I’ve been thinking about implementing something like this for a while - got excited by this tweet I thought I would do some exploring and write out a post over the weekend. Creating a county-level hex grid of Wisconsin makes for a perfect supplment to my earlier post about <a href="https://www.mikelee.co/posts/2016-12-26-wisconsin-presidential-election-results/">mapping the 2016 Wisconsin presidential results</a>.</p>
<hr />
</div>
<div id="lets-make-a-hex-grid-of-wisconsin" class="section level2">
<h2>Let’s make a hex grid of Wisconsin</h2>
<p>The first thing we’ll do is retrieve a Wisconsin shapefile; we can use the <code>tigris</code> package developed by Kyle Walker to pull a 2010 census shapefile of Wisconsin counties:</p>
<pre class="r"><code>library(tigris)
wi &lt;- counties(&quot;Wisconsin&quot;, cb = TRUE)</code></pre>
<pre><code>## 
  |                                                                                                                                        
  |                                                                                                                                  |   0%
  |                                                                                                                                        
  |=                                                                                                                                 |   0%
  |                                                                                                                                        
  |=                                                                                                                                 |   1%
  |                                                                                                                                        
  |==                                                                                                                                |   1%
  |                                                                                                                                        
  |==                                                                                                                                |   2%
  |                                                                                                                                        
  |===                                                                                                                               |   2%
  |                                                                                                                                        
  |===                                                                                                                               |   3%
  |                                                                                                                                        
  |====                                                                                                                              |   3%
  |                                                                                                                                        
  |=====                                                                                                                             |   4%
  |                                                                                                                                        
  |======                                                                                                                            |   4%
  |                                                                                                                                        
  |======                                                                                                                            |   5%
  |                                                                                                                                        
  |=======                                                                                                                           |   5%
  |                                                                                                                                        
  |=======                                                                                                                           |   6%
  |                                                                                                                                        
  |========                                                                                                                          |   6%
  |                                                                                                                                        
  |========                                                                                                                          |   7%
  |                                                                                                                                        
  |=========                                                                                                                         |   7%
  |                                                                                                                                        
  |==========                                                                                                                        |   7%
  |                                                                                                                                        
  |==========                                                                                                                        |   8%
  |                                                                                                                                        
  |===========                                                                                                                       |   8%
  |                                                                                                                                        
  |===========                                                                                                                       |   9%
  |                                                                                                                                        
  |============                                                                                                                      |   9%
  |                                                                                                                                        
  |============                                                                                                                      |  10%
  |                                                                                                                                        
  |=============                                                                                                                     |  10%
  |                                                                                                                                        
  |==============                                                                                                                    |  10%
  |                                                                                                                                        
  |==============                                                                                                                    |  11%
  |                                                                                                                                        
  |===============                                                                                                                   |  11%
  |                                                                                                                                        
  |===============                                                                                                                   |  12%
  |                                                                                                                                        
  |================                                                                                                                  |  12%
  |                                                                                                                                        
  |================                                                                                                                  |  13%
  |                                                                                                                                        
  |=================                                                                                                                 |  13%
  |                                                                                                                                        
  |==================                                                                                                                |  13%
  |                                                                                                                                        
  |==================                                                                                                                |  14%
  |                                                                                                                                        
  |===================                                                                                                               |  14%
  |                                                                                                                                        
  |===================                                                                                                               |  15%
  |                                                                                                                                        
  |====================                                                                                                              |  15%
  |                                                                                                                                        
  |====================                                                                                                              |  16%
  |                                                                                                                                        
  |=====================                                                                                                             |  16%
  |                                                                                                                                        
  |======================                                                                                                            |  17%
  |                                                                                                                                        
  |=======================                                                                                                           |  17%
  |                                                                                                                                        
  |=======================                                                                                                           |  18%
  |                                                                                                                                        
  |========================                                                                                                          |  18%
  |                                                                                                                                        
  |========================                                                                                                          |  19%
  |                                                                                                                                        
  |=========================                                                                                                         |  19%
  |                                                                                                                                        
  |=========================                                                                                                         |  20%
  |                                                                                                                                        
  |==========================                                                                                                        |  20%
  |                                                                                                                                        
  |===========================                                                                                                       |  20%
  |                                                                                                                                        
  |===========================                                                                                                       |  21%
  |                                                                                                                                        
  |============================                                                                                                      |  21%
  |                                                                                                                                        
  |============================                                                                                                      |  22%
  |                                                                                                                                        
  |=============================                                                                                                     |  22%
  |                                                                                                                                        
  |=============================                                                                                                     |  23%
  |                                                                                                                                        
  |==============================                                                                                                    |  23%
  |                                                                                                                                        
  |===============================                                                                                                   |  24%
  |                                                                                                                                        
  |================================                                                                                                  |  24%
  |                                                                                                                                        
  |================================                                                                                                  |  25%
  |                                                                                                                                        
  |=================================                                                                                                 |  25%
  |                                                                                                                                        
  |=================================                                                                                                 |  26%
  |                                                                                                                                        
  |==================================                                                                                                |  26%
  |                                                                                                                                        
  |===================================                                                                                               |  27%
  |                                                                                                                                        
  |====================================                                                                                              |  27%
  |                                                                                                                                        
  |====================================                                                                                              |  28%
  |                                                                                                                                        
  |=====================================                                                                                             |  28%
  |                                                                                                                                        
  |=====================================                                                                                             |  29%
  |                                                                                                                                        
  |======================================                                                                                            |  29%
  |                                                                                                                                        
  |======================================                                                                                            |  30%
  |                                                                                                                                        
  |=======================================                                                                                           |  30%
  |                                                                                                                                        
  |========================================                                                                                          |  30%
  |                                                                                                                                        
  |========================================                                                                                          |  31%
  |                                                                                                                                        
  |=========================================                                                                                         |  31%
  |                                                                                                                                        
  |=========================================                                                                                         |  32%
  |                                                                                                                                        
  |==========================================                                                                                        |  32%
  |                                                                                                                                        
  |==========================================                                                                                        |  33%
  |                                                                                                                                        
  |===========================================                                                                                       |  33%
  |                                                                                                                                        
  |============================================                                                                                      |  34%
  |                                                                                                                                        
  |=============================================                                                                                     |  34%
  |                                                                                                                                        
  |=============================================                                                                                     |  35%
  |                                                                                                                                        
  |==============================================                                                                                    |  35%
  |                                                                                                                                        
  |==============================================                                                                                    |  36%
  |                                                                                                                                        
  |===============================================                                                                                   |  36%
  |                                                                                                                                        
  |===============================================                                                                                   |  37%
  |                                                                                                                                        
  |================================================                                                                                  |  37%
  |                                                                                                                                        
  |=================================================                                                                                 |  37%
  |                                                                                                                                        
  |=================================================                                                                                 |  38%
  |                                                                                                                                        
  |==================================================                                                                                |  38%
  |                                                                                                                                        
  |==================================================                                                                                |  39%
  |                                                                                                                                        
  |===================================================                                                                               |  39%
  |                                                                                                                                        
  |===================================================                                                                               |  40%
  |                                                                                                                                        
  |====================================================                                                                              |  40%
  |                                                                                                                                        
  |=====================================================                                                                             |  41%
  |                                                                                                                                        
  |======================================================                                                                            |  41%
  |                                                                                                                                        
  |======================================================                                                                            |  42%
  |                                                                                                                                        
  |=======================================================                                                                           |  42%
  |                                                                                                                                        
  |=======================================================                                                                           |  43%
  |                                                                                                                                        
  |========================================================                                                                          |  43%
  |                                                                                                                                        
  |=========================================================                                                                         |  43%
  |                                                                                                                                        
  |=========================================================                                                                         |  44%
  |                                                                                                                                        
  |==========================================================                                                                        |  44%
  |                                                                                                                                        
  |==========================================================                                                                        |  45%
  |                                                                                                                                        
  |===========================================================                                                                       |  45%
  |                                                                                                                                        
  |===========================================================                                                                       |  46%
  |                                                                                                                                        
  |============================================================                                                                      |  46%
  |                                                                                                                                        
  |=============================================================                                                                     |  47%
  |                                                                                                                                        
  |==============================================================                                                                    |  47%
  |                                                                                                                                        
  |==============================================================                                                                    |  48%
  |                                                                                                                                        
  |===============================================================                                                                   |  48%
  |                                                                                                                                        
  |===============================================================                                                                   |  49%
  |                                                                                                                                        
  |================================================================                                                                  |  49%
  |                                                                                                                                        
  |================================================================                                                                  |  50%
  |                                                                                                                                        
  |=================================================================                                                                 |  50%
  |                                                                                                                                        
  |==================================================================                                                                |  50%
  |                                                                                                                                        
  |==================================================================                                                                |  51%
  |                                                                                                                                        
  |===================================================================                                                               |  51%
  |                                                                                                                                        
  |===================================================================                                                               |  52%
  |                                                                                                                                        
  |====================================================================                                                              |  52%
  |                                                                                                                                        
  |====================================================================                                                              |  53%
  |                                                                                                                                        
  |=====================================================================                                                             |  53%
  |                                                                                                                                        
  |======================================================================                                                            |  54%
  |                                                                                                                                        
  |=======================================================================                                                           |  54%
  |                                                                                                                                        
  |=======================================================================                                                           |  55%
  |                                                                                                                                        
  |========================================================================                                                          |  55%
  |                                                                                                                                        
  |========================================================================                                                          |  56%
  |                                                                                                                                        
  |=========================================================================                                                         |  56%
  |                                                                                                                                        
  |=========================================================================                                                         |  57%
  |                                                                                                                                        
  |==========================================================================                                                        |  57%
  |                                                                                                                                        
  |===========================================================================                                                       |  57%
  |                                                                                                                                        
  |===========================================================================                                                       |  58%
  |                                                                                                                                        
  |============================================================================                                                      |  58%
  |                                                                                                                                        
  |============================================================================                                                      |  59%
  |                                                                                                                                        
  |=============================================================================                                                     |  59%
  |                                                                                                                                        
  |=============================================================================                                                     |  60%
  |                                                                                                                                        
  |==============================================================================                                                    |  60%
  |                                                                                                                                        
  |===============================================================================                                                   |  60%
  |                                                                                                                                        
  |===============================================================================                                                   |  61%
  |                                                                                                                                        
  |================================================================================                                                  |  61%
  |                                                                                                                                        
  |================================================================================                                                  |  62%
  |                                                                                                                                        
  |=================================================================================                                                 |  62%
  |                                                                                                                                        
  |=================================================================================                                                 |  63%
  |                                                                                                                                        
  |==================================================================================                                                |  63%
  |                                                                                                                                        
  |===================================================================================                                               |  63%
  |                                                                                                                                        
  |===================================================================================                                               |  64%
  |                                                                                                                                        
  |====================================================================================                                              |  64%
  |                                                                                                                                        
  |====================================================================================                                              |  65%
  |                                                                                                                                        
  |=====================================================================================                                             |  65%
  |                                                                                                                                        
  |=====================================================================================                                             |  66%
  |                                                                                                                                        
  |======================================================================================                                            |  66%
  |                                                                                                                                        
  |=======================================================================================                                           |  67%
  |                                                                                                                                        
  |========================================================================================                                          |  67%
  |                                                                                                                                        
  |========================================================================================                                          |  68%
  |                                                                                                                                        
  |=========================================================================================                                         |  68%
  |                                                                                                                                        
  |=========================================================================================                                         |  69%
  |                                                                                                                                        
  |==========================================================================================                                        |  69%
  |                                                                                                                                        
  |==========================================================================================                                        |  70%
  |                                                                                                                                        
  |===========================================================================================                                       |  70%
  |                                                                                                                                        
  |============================================================================================                                      |  70%
  |                                                                                                                                        
  |============================================================================================                                      |  71%
  |                                                                                                                                        
  |=============================================================================================                                     |  71%
  |                                                                                                                                        
  |=============================================================================================                                     |  72%
  |                                                                                                                                        
  |==============================================================================================                                    |  72%
  |                                                                                                                                        
  |==============================================================================================                                    |  73%
  |                                                                                                                                        
  |===============================================================================================                                   |  73%
  |                                                                                                                                        
  |================================================================================================                                  |  74%
  |                                                                                                                                        
  |=================================================================================================                                 |  74%
  |                                                                                                                                        
  |=================================================================================================                                 |  75%
  |                                                                                                                                        
  |==================================================================================================                                |  75%
  |                                                                                                                                        
  |==================================================================================================                                |  76%
  |                                                                                                                                        
  |===================================================================================================                               |  76%
  |                                                                                                                                        
  |====================================================================================================                              |  77%
  |                                                                                                                                        
  |=====================================================================================================                             |  77%
  |                                                                                                                                        
  |=====================================================================================================                             |  78%
  |                                                                                                                                        
  |======================================================================================================                            |  78%
  |                                                                                                                                        
  |======================================================================================================                            |  79%
  |                                                                                                                                        
  |=======================================================================================================                           |  79%
  |                                                                                                                                        
  |=======================================================================================================                           |  80%
  |                                                                                                                                        
  |========================================================================================================                          |  80%
  |                                                                                                                                        
  |=========================================================================================================                         |  80%
  |                                                                                                                                        
  |=========================================================================================================                         |  81%
  |                                                                                                                                        
  |==========================================================================================================                        |  81%
  |                                                                                                                                        
  |==========================================================================================================                        |  82%
  |                                                                                                                                        
  |===========================================================================================================                       |  82%
  |                                                                                                                                        
  |===========================================================================================================                       |  83%
  |                                                                                                                                        
  |============================================================================================================                      |  83%
  |                                                                                                                                        
  |=============================================================================================================                     |  84%
  |                                                                                                                                        
  |==============================================================================================================                    |  84%
  |                                                                                                                                        
  |==============================================================================================================                    |  85%
  |                                                                                                                                        
  |===============================================================================================================                   |  85%
  |                                                                                                                                        
  |===============================================================================================================                   |  86%
  |                                                                                                                                        
  |================================================================================================================                  |  86%
  |                                                                                                                                        
  |================================================================================================================                  |  87%
  |                                                                                                                                        
  |=================================================================================================================                 |  87%
  |                                                                                                                                        
  |==================================================================================================================                |  87%
  |                                                                                                                                        
  |==================================================================================================================                |  88%
  |                                                                                                                                        
  |===================================================================================================================               |  88%
  |                                                                                                                                        
  |===================================================================================================================               |  89%
  |                                                                                                                                        
  |====================================================================================================================              |  89%
  |                                                                                                                                        
  |====================================================================================================================              |  90%
  |                                                                                                                                        
  |=====================================================================================================================             |  90%
  |                                                                                                                                        
  |======================================================================================================================            |  91%
  |                                                                                                                                        
  |=======================================================================================================================           |  91%
  |                                                                                                                                        
  |=======================================================================================================================           |  92%
  |                                                                                                                                        
  |========================================================================================================================          |  92%
  |                                                                                                                                        
  |========================================================================================================================          |  93%
  |                                                                                                                                        
  |=========================================================================================================================         |  93%
  |                                                                                                                                        
  |==========================================================================================================================        |  93%
  |                                                                                                                                        
  |==========================================================================================================================        |  94%
  |                                                                                                                                        
  |===========================================================================================================================       |  94%
  |                                                                                                                                        
  |===========================================================================================================================       |  95%
  |                                                                                                                                        
  |============================================================================================================================      |  95%
  |                                                                                                                                        
  |============================================================================================================================      |  96%
  |                                                                                                                                        
  |=============================================================================================================================     |  96%
  |                                                                                                                                        
  |==============================================================================================================================    |  97%
  |                                                                                                                                        
  |===============================================================================================================================   |  97%
  |                                                                                                                                        
  |===============================================================================================================================   |  98%
  |                                                                                                                                        
  |================================================================================================================================  |  98%
  |                                                                                                                                        
  |================================================================================================================================  |  99%
  |                                                                                                                                        
  |================================================================================================================================= |  99%
  |                                                                                                                                        
  |================================================================================================================================= | 100%
  |                                                                                                                                        
  |==================================================================================================================================| 100%</code></pre>
<pre class="r"><code>wi_original &lt;- wi
plot(wi)</code></pre>
<p><img src="/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/tigris%20shapefile-1.png" width="1800" style="display: block; margin: auto;" /></p>
<p>We’ll then port some code from the <code>hexmapr</code> github README:</p>
<pre class="r"><code>library(hexmapr)
wi_details &lt;- get_shape_details(wi)
wi@data$xcentroid &lt;- coordinates(wi)[,1]
wi@data$ycentroid &lt;- coordinates(wi)[,2]</code></pre>
<p>We’re going for the closest shapefile match, preferring a final shape than looks like the outline of the state than one with appropriate placement of counties - there is rarely a perfect grid match. So let’s test a whole bunch:</p>
<pre class="r"><code># hexagon - red border for the 28th seed
png(file = &quot;/home/michael/Documents/mikeleeco.github.com/static/img/hexGridWisconsin.png&quot;, width = 700, height = 500)
par(mfrow=c(7,5), mar = c(0,1,2,1))
for (i in 1:35){
  new_cells &lt;-  calculate_cell_size(wi, wi_details,0.03, &#39;hexagonal&#39;, i)
  if(i == 28) {
    plot(new_cells[[2]], main = paste(&quot;Seed&quot;,i, sep=&quot; &quot;), border = &quot;red&quot;)
  } else {
    plot(new_cells[[2]], main = paste(&quot;Seed&quot;,i, sep=&quot; &quot;))
  }
}

# squares - red border for the 7th seed
png(file = &quot;/home/michael/Documents/mikeleeco.github.com/static/img/squareGridWisconsin.png&quot;, width = 700, height = 500)
par(mfrow=c(7,5), mar = c(0,1,2,1))
for (i in 1:35){
  new_cells &lt;-  calculate_cell_size(wi, wi_details,0.03, &#39;regular&#39;, i)
  if(i == 7) {
    plot(new_cells[[2]], main = paste(&quot;Seed&quot;,i, sep=&quot; &quot;), border = &quot;red&quot;)
  } else {
    plot(new_cells[[2]], main = paste(&quot;Seed&quot;,i, sep=&quot; &quot;))
  }
}</code></pre>
<div class="figure">
<img src="/img/hexGridWisconsin.png" alt="hex grid options" />
<p class="caption">hex grid options</p>
</div>
<div class="figure">
<img src="/img/squareGridWisconsin.png" alt="square grid options" />
<p class="caption">square grid options</p>
</div>
<p>I like the look of the 28th hexagon grid, and the 7th square grid. Let’s take those and assign the polygons to a new <code>SpatialPolygonsDataFrame</code>, then fortify .</p>
<pre class="r"><code>library(dplyr)
library(ggplot2)
clean &lt;- function(shape){
  shape@data$id = rownames(shape@data)
  shape.points = fortify(shape, region=&quot;id&quot;)
  shape.df = left_join(shape.points, shape@data, by=&quot;id&quot;)
}

new_cells_hex &lt;-  calculate_cell_size(wi_original, wi_details,0.03, &#39;hexagonal&#39;, 28)
resulthex &lt;- assign_polygons(wi_original,new_cells_hex)
result_df_hex &lt;- clean(resulthex)

new_cells_square &lt;-  calculate_cell_size(wi_original, wi_details,0.03, &#39;regular&#39;, 7)
resultsquare &lt;- assign_polygons(wi_original,new_cells_square)
result_df_square &lt;- clean(resultsquare)</code></pre>
<p>Now that we’ve got our modified <code>SpatialPolygonsDataFrame</code>s - covered to a dataframe for use with ggplot2 - we can plot the result using <code>geom_polygon</code>:</p>
<pre class="r"><code>library(viridis)
library(extrafont)
loadfonts()
theme_open_sans &lt;- theme(text=element_text(family=&quot;Open Sans&quot;), plot.title = element_text(family = &quot;Open Sans Semibold&quot;, size = 24), plot.subtitle = element_text(family = &quot;Open Sans Light&quot;,size = 14), legend.title = element_text(family=&quot;Open Sans Semibold&quot;))
hexplot &lt;- ggplot(result_df_hex) +
  geom_polygon(aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))+
  geom_text(aes(V1, V2, label = NAME), size=2.5, color = &quot;white&quot;, family = &quot;Open Sans&quot;) +
  scale_fill_viridis() +
  guides(fill=FALSE) +
  theme_void() + theme_open_sans

hexplot</code></pre>
<p><img src="/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/square%20and%20hex%20plots%20of%20WI-1.png" width="1800" style="display: block; margin: auto;" /></p>
<pre class="r"><code>squareplot &lt;- ggplot(result_df_square) +
  geom_polygon(aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))+
  geom_text(aes(V1, V2, label = NAME), size=2.5, color = &quot;white&quot;, family = &quot;Open Sans&quot;) +
  scale_fill_viridis() +
  guides(fill=FALSE) +
  theme_void() + theme_open_sans

squareplot</code></pre>
<p><img src="/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/square%20and%20hex%20plots%20of%20WI-2.png" width="1800" style="display: block; margin: auto;" /></p>
<p>I saw on twitter that <code>sf</code> can now be used natively, so I gave that I try as well. First convert the <code>SpatialPolygonsDataFrame</code> to a simple feature (<code>sf</code>), then plot the resultant object using <code>geom_sf</code>:</p>
<pre class="r"><code>sfResultSquare &lt;- st_as_sf(resultsquare)
sfResultHex &lt;- st_as_sf(resulthex)
class(sfResultHex)</code></pre>
<pre><code>## [1] &quot;sf&quot;         &quot;data.frame&quot;</code></pre>
<pre class="r"><code>sfHexPlot &lt;-ggplot(sfResultHex) +
    geom_sf(aes(fill = as.numeric(ALAND)), color = &quot;transparent&quot;) +
    geom_text(aes(V1, V2, label = NAME), size=2.5, color = &quot;white&quot;, family = &quot;Open Sans&quot;) +
    scale_fill_viridis() +
    guides(fill=FALSE) +
    theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())

sfHexPlot</code></pre>
<p><img src="/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/hexgrid%20with%20sf-1.png" width="1800" style="display: block; margin: auto;" /></p>
<p>Cool to know that’s possible! Let’s use some more novel data than land area. Building off of a previous post mapping Wisconsin presidential election results, let’s map vote totals to our new gridmaps.</p>
<pre class="r"><code>library(stringr)
library(tidyr)
all_results &lt;- read.csv(&quot;https://raw.githubusercontent.com/mkearney/presidential_election_county_results_2016/master/pres16results.csv&quot;, stringsAsFactors = FALSE)

wisconsin &lt;- all_results %&gt;% 
  filter(str_detect(fips, &quot;^55&quot;))

wisconsin_spread &lt;- wisconsin %&gt;% 
  filter(cand %in% c(&quot;Donald Trump&quot;, &quot;Hillary Clinton&quot;)) %&gt;%
  select(fips, cand, votes, total_votes) %&gt;%
  spread(cand, votes)

wisconsin_spread &lt;- wisconsin_spread %&gt;% mutate(voteDiff = `Donald Trump` - `Hillary Clinton`,
                                                pctDiff = `Donald Trump`/total_votes - `Hillary Clinton`/total_votes,
                                                weight = total_votes/ sum(total_votes))
wisconsin_spread$weight &lt;- ifelse(wisconsin_spread$pctDiff &gt; 0 , -wisconsin_spread$weight, wisconsin_spread$weight)</code></pre>
<p>We can create some custom breaks to give counties with higher vote totals more prominence in the figure, then merge these onto our hex and square <code>SpatialPolygonsDataFrame</code>:</p>
<pre class="r"><code>wisconsin_spread$breaks &lt;- cut(wisconsin_spread$weight,
                               breaks = c(-1, -.1, -0.05, -0.01, 0, 0.01, .05, .1, 1),
                               labels = c(&quot;R   More than 10 Percent&quot;, &quot;R   5 to 10 Percent&quot;, &quot;R   1 to 5 Percent&quot;, &quot;R   Less than 1 Percent&quot;, 
                                          &quot;D   Less than 1 Percent&quot;,&quot;D   1 to 5 Percent&quot;, &quot;D   5 to 10 Percent&quot;, &quot;D   More than 10 Percent&quot;))
wiHex &lt;- merge(result_df_hex, wisconsin_spread, by.x = &quot;GEOID&quot;, by.y = &quot;fips&quot;)
wiSquare &lt;- merge(result_df_square, wisconsin_spread, by.x = &quot;GEOID&quot;, by.y = &quot;fips&quot;)</code></pre>
<p>Once we’ve got our data sets finalized, figures are created usng <code>geom_polygon</code>:</p>
<pre class="r"><code>library(RColorBrewer)

wiHexPlot &lt;- ggplot(wiHex) +
    geom_polygon(aes(x=long, y=lat, fill=breaks, group = group), color = &quot;#f5f5f5&quot;) +
    geom_text(aes(V1, V2, label = NAME), size=2.5, color = &quot;black&quot;, family = &quot;Open Sans&quot;) +
    scale_fill_manual(name = &quot;Portion of WI Vote&quot;, values = brewer.pal(8, &quot;RdBu&quot;), drop = FALSE) +
    guides(alpha=FALSE) +
    ggtitle(label = &quot;2016 Presidential Results by Wisconsin Counties&quot;, subtitle = &quot;59 of 72 Wisconsin counties leaned Republican, while the only two counties with\nmore than 10 percent of the state&#39;s votes totaled more Democratic votes&quot;) +
    theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank()) +   
    theme_open_sans

wiHexPlot</code></pre>
<p><img src="/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/join%20election%20results%20to%20sf%20object-1.png" width="1800" style="display: block; margin: auto;" /></p>
<pre class="r"><code>wiSquarePlot &lt;- ggplot(wiSquare) +
    geom_polygon(aes(x=long, y=lat, fill=breaks, group = group), color = &quot;#f5f5f5&quot;) +
    geom_text(aes(V1, V2, label = NAME), size=2.5, color = &quot;black&quot;, family = &quot;Open Sans&quot;) +
    scale_fill_manual(name = &quot;Percentage of WI Vote Total&quot;, values = brewer.pal(8, &quot;RdBu&quot;), drop = FALSE) +
    guides(alpha=FALSE) +
    ggtitle(label = &quot;2016 Presidential Results by Wisconsin Counties&quot;, subtitle = &quot;59 of 72 Wisconsin counties leaned Republican, while the only two counties with\nmore than 10 percent of the state&#39;s votes totaled more Democratic votes&quot;) +
    theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank()) +   
    theme_open_sans

wiSquarePlot</code></pre>
<p><img src="/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/join%20election%20results%20to%20sf%20object-2.png" width="1800" style="display: block; margin: auto;" /></p>
<hr />
<p>Interested in learning more? Hire me to consult on your next project, follow me on <a href="https://twitter.com/mikeleeco">twitter</a>, leave a comment, or contact me via <a href="mailto:mdlee12@gmail.com">email</a>. All inquiries welcome!</p>
</div>
