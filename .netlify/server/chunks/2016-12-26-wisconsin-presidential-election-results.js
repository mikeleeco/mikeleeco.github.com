import "clsx";
import { h as html } from "./html.js";
const metadata = {
  "title": "Mapping Wisconsin Presidential Election Results",
  "description": "Wisconsin played a major role in the presidential election, but the result is not due to major differences with its Midwest neighbor.",
  "tags": ["R", "ggplot2", "politics", "dataviz"],
  "date": "2017-01-05",
  "featured": true,
  "categories": "posts",
  "img": "/img/WisconsinMinnesota.png"
};
const { title, description, tags, date, featured, categories, img } = metadata;
function _016_12_26_wisconsin_presidential_election_results_md($$payload) {
  $$payload.out += `<h4><em>“Your home state did us no favors…”</em></h4> <p>As a Wisconsinite transplanted into the highest density of left-leaning voters in the country (District of Columbia) I’ve heard from several friends over the weeks in the aftermath of the US presidential election that voters in my home state should shoulder responsibility for contributing to Donald Trump winning an electoral majority.</p> <p>The “winner-take-all” basis in which electoral votes are allocated means the margin of victory in each state is null - extra votes don’t matter - which contributes to an outcome in which a winning candidate can have fewer total votes than another nominee.</p> <h4>Big Idea</h4> <p>The urban/rural divide has been a popular explanation for Donald Trump’s electoral victory in the 2016 presidential election. Does this theory explain why Trump won Wisconsin and Clinton won Minnesota?</p> <p>This post seeks to explore this idea. First, a bit of background. These two Midwestern neighbors have striking <a href="http://www.indexmundi.com/facts/united-states/quick-facts/compare/wisconsin.minnesota" rel="nofollow">population, demographic, and social indicator similarities</a>. Recent gubernatorial and congressional elections in both states have resulted in major party shifts. The policies of Wisconsin’s Republican governor Scott Walker and Minnesota’s Democratic governor Mark Dayton and their impact on state success has inspired <a href="https://www.google.com/#q=wisconsin+and+minnesota+government" rel="nofollow">several comparisons and juxtaposed analyses</a>. While each state has elected Republican or Independent candidates as governors in the last few decades, the Democratic nominee has won each state in 7 straight presidential elections from 1988 to 2012.</p> <p>Let’s try to unpack the voting results in each state in 2016.</p> <h4>Wisconsin Voting Results</h4> <p>I started this analysis using Julia Silge’s <a href="http://juliasilge.com/blog/Election-Mapping/" rel="nofollow">Utah Election Mapping</a> script, then supplemented these analyses with urban and rural county population numbers from the 2010 Census. First, I loaded the R package libraries. Next, I read in the county level 2016 presidential election results and 2010 census data:</p> <pre class="language-r">${html(`<code class="language-r">library<span class="token punctuation">(</span>readr<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>choroplethr<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>choroplethrMaps<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>ggplot2<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>ggthemes<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>RColorBrewer<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>gridExtra<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>dplyr<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>stringr<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>tidyr<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>extrafont<span class="token punctuation">)</span>
extrafont<span class="token operator">::</span>loadfonts<span class="token punctuation">(</span>quiet <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

all_results <span class="token operator">&lt;-</span> read_csv<span class="token punctuation">(</span><span class="token string">"https://raw.githubusercontent.com/mkearney/presidential_election_county_results_2016/master/pres16results.csv"</span><span class="token punctuation">)</span>

urban <span class="token operator">&lt;-</span> read.table<span class="token punctuation">(</span><span class="token string">"http://www2.census.gov/geo/docs/reference/ua/PctUrbanRural_County.txt"</span><span class="token punctuation">,</span>
                  header<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">","</span><span class="token punctuation">,</span> colClasses <span class="token operator">=</span> <span class="token string">"character"</span><span class="token punctuation">)</span>
urban<span class="token operator">$</span>fips <span class="token operator">&lt;-</span> paste0<span class="token punctuation">(</span>urban<span class="token operator">$</span>STATE<span class="token punctuation">,</span>urban<span class="token operator">$</span>COUNTY<span class="token punctuation">)</span>
urban <span class="token operator">&lt;-</span> urban <span class="token percent-operator operator">%>%</span> select<span class="token punctuation">(</span>POP_COU<span class="token punctuation">,</span> POPPCT_URBAN<span class="token punctuation">,</span> fips<span class="token punctuation">)</span>
urban<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> sapply<span class="token punctuation">(</span>urban<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> as.numeric<span class="token punctuation">)</span>
all_results <span class="token operator">&lt;-</span> left_join<span class="token punctuation">(</span>all_results<span class="token punctuation">,</span>urban<span class="token punctuation">)</span></code>`)}</pre> <p>Once the data is read and joined together through the <code>fips</code> code in each data set, we can subset <code>all_results</code> to determine the percent of votes allocated for the two major party candidates, as well as the two most popular candidates from alternative parties:</p> <pre class="language-r">${html(`<code class="language-r">wisconsin <span class="token operator">&lt;-</span> all_results <span class="token percent-operator operator">%>%</span>
  filter<span class="token punctuation">(</span>str_detect<span class="token punctuation">(</span>fips<span class="token punctuation">,</span> <span class="token string">"^55"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code>`)}</pre> <pre class="language-r">${html(`<code class="language-r">wisconsin_spread <span class="token operator">&lt;-</span> wisconsin <span class="token percent-operator operator">%>%</span>
  filter<span class="token punctuation">(</span>cand <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">"Donald Trump"</span><span class="token punctuation">,</span> <span class="token string">"Hillary Clinton"</span><span class="token punctuation">,</span> <span class="token string">"Gary Johnson"</span><span class="token punctuation">,</span> <span class="token string">"Jill Stein"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  select<span class="token punctuation">(</span>fips<span class="token punctuation">,</span> cand<span class="token punctuation">,</span> pct<span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  mutate<span class="token punctuation">(</span>pct <span class="token operator">=</span> pct <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span>
         region <span class="token operator">=</span> as.numeric<span class="token punctuation">(</span>fips<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  spread<span class="token punctuation">(</span>cand<span class="token punctuation">,</span> pct<span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  select<span class="token punctuation">(</span><span class="token operator">-</span>fips<span class="token punctuation">)</span>

wisconsin_spread</code>`)}</pre> <pre class="language-r">${html(`<code class="language-r"><span class="token comment">## # A tibble: 72 × 5</span>
<span class="token comment">##    region &#96;Donald Trump&#96; &#96;Gary Johnson&#96; &#96;Hillary Clinton&#96; &#96;Jill Stein&#96;</span>
<span class="token comment">## *   &lt;dbl>          &lt;dbl>          &lt;dbl>             &lt;dbl>        &lt;dbl></span>
<span class="token comment">## 1   55001       59.19660       2.048085          37.39982    0.7915306</span>
<span class="token comment">## 2   55003       43.25006       2.296240          52.18269    1.7663386</span>
<span class="token comment">## 3   55005       60.38465       3.224660          35.00489    0.7506440</span>
<span class="token comment">## 4   55007       43.46223       1.959751          52.18628    1.9492150</span>
<span class="token comment">## 5   55009       52.70085       3.907543          41.85040    1.0753194</span>
<span class="token comment">## 6   55011       58.50311       3.149834          36.56986    1.0692097</span>
<span class="token comment">## 7   55013       62.07134       2.626448          33.81122    0.7684367</span>
<span class="token comment">## 8   55015       58.06122       3.980476          36.45238    0.7718794</span>
<span class="token comment">## 9   55017       56.91589       3.835277          37.73315    0.8388675</span>
<span class="token comment">## 10  55019       63.81016       3.291999          31.18541    0.7897845</span>
<span class="token comment">## # ... with 62 more rows</span></code>`)}</pre> <p>Now that our data has been reshaped, we can further subset by candidate to create county-level voting maps, using Ari Lamstein’s <a href="https://cran.r-project.org/web/packages/choroplethr/index.html" rel="nofollow">choroplethr</a> package.</p> <pre class="language-r">${html(`<code class="language-r">wisconsin_spread<span class="token operator">$</span>value <span class="token operator">&lt;-</span> wisconsin_spread<span class="token operator">$</span>&#96;Donald Trump&#96;
choro1 <span class="token operator">=</span> CountyChoropleth<span class="token operator">$</span>new<span class="token punctuation">(</span>wisconsin_spread<span class="token punctuation">)</span>
choro1<span class="token operator">$</span>set_zoom<span class="token punctuation">(</span><span class="token string">"wisconsin"</span><span class="token punctuation">)</span>
choro1<span class="token operator">$</span>title <span class="token operator">=</span> <span class="token string">"Donald Trump"</span>
choro1<span class="token operator">$</span>set_num_colors<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
choro1<span class="token operator">$</span>ggplot_polygon <span class="token operator">=</span> geom_polygon<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>fill <span class="token operator">=</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
choro1<span class="token operator">$</span>ggplot_scale <span class="token operator">=</span> scale_fill_gradientn<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Percent"</span><span class="token punctuation">,</span>
                                           colours <span class="token operator">=</span> brewer.pal<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"Reds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

wisconsin_spread<span class="token operator">$</span>value <span class="token operator">&lt;-</span> wisconsin_spread<span class="token operator">$</span>&#96;Hillary Clinton&#96;
choro2 <span class="token operator">=</span> CountyChoropleth<span class="token operator">$</span>new<span class="token punctuation">(</span>wisconsin_spread<span class="token punctuation">)</span>
choro2<span class="token operator">$</span>set_zoom<span class="token punctuation">(</span><span class="token string">"wisconsin"</span><span class="token punctuation">)</span>
choro2<span class="token operator">$</span>title <span class="token operator">=</span> <span class="token string">"Hillary Clinton"</span>
choro2<span class="token operator">$</span>set_num_colors<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
choro2<span class="token operator">$</span>ggplot_polygon <span class="token operator">=</span> geom_polygon<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>fill <span class="token operator">=</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
choro2<span class="token operator">$</span>ggplot_scale <span class="token operator">=</span> scale_fill_gradientn<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Percent"</span><span class="token punctuation">,</span>
                                           colours <span class="token operator">=</span> brewer.pal<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"Blues"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

wisconsin_spread<span class="token operator">$</span>value <span class="token operator">&lt;-</span> wisconsin_spread<span class="token operator">$</span>&#96;Gary Johnson&#96;
choro3 <span class="token operator">=</span> CountyChoropleth<span class="token operator">$</span>new<span class="token punctuation">(</span>wisconsin_spread<span class="token punctuation">)</span>
choro3<span class="token operator">$</span>set_zoom<span class="token punctuation">(</span><span class="token string">"wisconsin"</span><span class="token punctuation">)</span>
choro3<span class="token operator">$</span>title <span class="token operator">=</span> <span class="token string">"Gary Johnson"</span>
choro3<span class="token operator">$</span>set_num_colors<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
choro3<span class="token operator">$</span>ggplot_polygon <span class="token operator">=</span> geom_polygon<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>fill <span class="token operator">=</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
choro3<span class="token operator">$</span>ggplot_scale <span class="token operator">=</span> scale_fill_gradientn<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Percent"</span><span class="token punctuation">,</span>
                                           colours <span class="token operator">=</span> brewer.pal<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"Purples"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

wisconsin_spread<span class="token operator">$</span>value <span class="token operator">&lt;-</span> wisconsin_spread<span class="token operator">$</span>&#96;Jill Stein&#96;
choro4 <span class="token operator">=</span> CountyChoropleth<span class="token operator">$</span>new<span class="token punctuation">(</span>wisconsin_spread<span class="token punctuation">)</span>
choro4<span class="token operator">$</span>set_zoom<span class="token punctuation">(</span><span class="token string">"wisconsin"</span><span class="token punctuation">)</span>
choro4<span class="token operator">$</span>title <span class="token operator">=</span> <span class="token string">"Jill Stein"</span>
choro4<span class="token operator">$</span>set_num_colors<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
choro4<span class="token operator">$</span>ggplot_polygon <span class="token operator">=</span> geom_polygon<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>fill <span class="token operator">=</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
choro4<span class="token operator">$</span>ggplot_scale <span class="token operator">=</span> scale_fill_gradientn<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Percent"</span><span class="token punctuation">,</span>
                                           colours <span class="token operator">=</span> brewer.pal<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"Greens"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

grid.arrange<span class="token punctuation">(</span>choro1<span class="token operator">$</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> theme<span class="token punctuation">(</span>text<span class="token operator">=</span>element_text<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             choro2<span class="token operator">$</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> theme<span class="token punctuation">(</span>text<span class="token operator">=</span>element_text<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             choro3<span class="token operator">$</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> theme<span class="token punctuation">(</span>text<span class="token operator">=</span>element_text<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             choro4<span class="token operator">$</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> theme<span class="token punctuation">(</span>text<span class="token operator">=</span>element_text<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></code>`)}</pre> <div><img src="/img/WisconsinPresidentialElectionResultsbyCounty-1.png" title="plot of chunk Wisconsin Presidential Election Results by County" alt="plot of chunk Wisconsin Presidential Election Results by County" style="display: block; margin: auto;"/></div> <p>A bar graph more accurately displays the results by candidate. Wisconsin’s 10 electoral votes were decided by only 27257 votes! That is a really small margin.</p> <pre class="language-r">${html(`<code class="language-r">votes <span class="token operator">&lt;-</span> wisconsin <span class="token percent-operator operator">%>%</span>
  filter<span class="token punctuation">(</span>cand <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">"Donald Trump"</span><span class="token punctuation">,</span> <span class="token string">"Hillary Clinton"</span><span class="token punctuation">,</span> <span class="token string">"Gary Johnson"</span><span class="token punctuation">,</span><span class="token string">"Jill Stein"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  mutate<span class="token punctuation">(</span>cand <span class="token operator">=</span> factor<span class="token punctuation">(</span>cand<span class="token punctuation">,</span> levels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Donald Trump"</span><span class="token punctuation">,</span> <span class="token string">"Hillary Clinton"</span><span class="token punctuation">,</span> <span class="token string">"Gary Johnson"</span><span class="token punctuation">,</span><span class="token string">"Jill Stein"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  group_by<span class="token punctuation">(</span>cand<span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  summarise<span class="token punctuation">(</span>sum <span class="token operator">=</span> sum<span class="token punctuation">(</span>votes<span class="token punctuation">)</span><span class="token punctuation">)</span>

ggplot<span class="token punctuation">(</span>votes<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>cand<span class="token punctuation">,</span> sum<span class="token punctuation">,</span> fill <span class="token operator">=</span> cand<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_bar<span class="token punctuation">(</span>stat <span class="token operator">=</span> <span class="token string">"identity"</span><span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme_tufte<span class="token punctuation">(</span>base_family <span class="token operator">=</span> <span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  scale_fill_manual<span class="token punctuation">(</span>values <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"red3"</span><span class="token punctuation">,</span> <span class="token string">"navyblue"</span><span class="token punctuation">,</span> <span class="token string">"#6A51A3"</span><span class="token punctuation">,</span><span class="token string">"darkgreen"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme<span class="token punctuation">(</span>legend.position<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  labs<span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">"Total Votes Cast in Wisconsin"</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">"Number of votes"</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code>`)}</pre> <div><img src="/img/WisconsinPresidentialElectionResultsBarChart-1.png" title="plot of chunk Wisconsin Presidential Election Results Bar Chart" alt="plot of chunk Wisconsin Presidential Election Results Bar Chart" style="display: block; margin: auto;"/></div> <h4>Wisconsin and Minnesota Voting Results</h4> <p>To get a better sense of how the results compare, lets perform the same analyses using both Wisconsin and Minnesota data.</p> <pre class="language-r">${html(`<code class="language-r">minnesotawisconsin <span class="token operator">&lt;-</span> all_results <span class="token percent-operator operator">%>%</span>
  filter<span class="token punctuation">(</span>str_detect<span class="token punctuation">(</span>fips<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"^55"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> str_detect<span class="token punctuation">(</span>fips<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"^27"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code>`)}</pre> <pre class="language-r">${html(`<code class="language-r">minnesotawisconsin_spread <span class="token operator">&lt;-</span> minnesotawisconsin <span class="token percent-operator operator">%>%</span>
  filter<span class="token punctuation">(</span>cand <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">"Donald Trump"</span><span class="token punctuation">,</span> <span class="token string">"Hillary Clinton"</span><span class="token punctuation">,</span> <span class="token string">"Gary Johnson"</span><span class="token punctuation">,</span> <span class="token string">"Jill Stein"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  select<span class="token punctuation">(</span>fips<span class="token punctuation">,</span> cand<span class="token punctuation">,</span> pct<span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  mutate<span class="token punctuation">(</span>pct <span class="token operator">=</span> pct <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span>
         region <span class="token operator">=</span> as.numeric<span class="token punctuation">(</span>fips<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  spread<span class="token punctuation">(</span>cand<span class="token punctuation">,</span> pct<span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  select<span class="token punctuation">(</span><span class="token operator">-</span>fips<span class="token punctuation">)</span>

minnesotawisconsin_spread<span class="token operator">$</span>value <span class="token operator">&lt;-</span> minnesotawisconsin_spread<span class="token operator">$</span>&#96;Donald Trump&#96;
choro1 <span class="token operator">=</span> CountyChoropleth<span class="token operator">$</span>new<span class="token punctuation">(</span>minnesotawisconsin_spread<span class="token punctuation">)</span>
choro1<span class="token operator">$</span>set_zoom<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"minnesota"</span><span class="token punctuation">,</span><span class="token string">"wisconsin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
choro1<span class="token operator">$</span>title <span class="token operator">=</span> <span class="token string">"Donald Trump"</span>
choro1<span class="token operator">$</span>set_num_colors<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
choro1<span class="token operator">$</span>ggplot_polygon <span class="token operator">=</span> geom_polygon<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>fill <span class="token operator">=</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
choro1<span class="token operator">$</span>ggplot_scale <span class="token operator">=</span> scale_fill_gradientn<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Percent"</span><span class="token punctuation">,</span>
                                           colours <span class="token operator">=</span> brewer.pal<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"Reds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

minnesotawisconsin_spread<span class="token operator">$</span>value <span class="token operator">&lt;-</span> minnesotawisconsin_spread<span class="token operator">$</span>&#96;Hillary Clinton&#96;
choro2 <span class="token operator">=</span> CountyChoropleth<span class="token operator">$</span>new<span class="token punctuation">(</span>minnesotawisconsin_spread<span class="token punctuation">)</span>
choro2<span class="token operator">$</span>set_zoom<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"minnesota"</span><span class="token punctuation">,</span><span class="token string">"wisconsin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
choro2<span class="token operator">$</span>title <span class="token operator">=</span> <span class="token string">"Hillary Clinton"</span>
choro2<span class="token operator">$</span>set_num_colors<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
choro2<span class="token operator">$</span>ggplot_polygon <span class="token operator">=</span> geom_polygon<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>fill <span class="token operator">=</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
choro2<span class="token operator">$</span>ggplot_scale <span class="token operator">=</span> scale_fill_gradientn<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Percent"</span><span class="token punctuation">,</span>
                                           colours <span class="token operator">=</span> brewer.pal<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"Blues"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

minnesotawisconsin_spread<span class="token operator">$</span>value <span class="token operator">&lt;-</span> minnesotawisconsin_spread<span class="token operator">$</span>&#96;Gary Johnson&#96;
choro3 <span class="token operator">=</span> CountyChoropleth<span class="token operator">$</span>new<span class="token punctuation">(</span>minnesotawisconsin_spread<span class="token punctuation">)</span>
choro3<span class="token operator">$</span>set_zoom<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"minnesota"</span><span class="token punctuation">,</span><span class="token string">"wisconsin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
choro3<span class="token operator">$</span>title <span class="token operator">=</span> <span class="token string">"Gary Johnson"</span>
choro3<span class="token operator">$</span>set_num_colors<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
choro3<span class="token operator">$</span>ggplot_polygon <span class="token operator">=</span> geom_polygon<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>fill <span class="token operator">=</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
choro3<span class="token operator">$</span>ggplot_scale <span class="token operator">=</span> scale_fill_gradientn<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Percent"</span><span class="token punctuation">,</span>
                                           colours <span class="token operator">=</span> brewer.pal<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"Purples"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

minnesotawisconsin_spread<span class="token operator">$</span>value <span class="token operator">&lt;-</span> minnesotawisconsin_spread<span class="token operator">$</span>&#96;Jill Stein&#96;
choro4 <span class="token operator">=</span> CountyChoropleth<span class="token operator">$</span>new<span class="token punctuation">(</span>minnesotawisconsin_spread<span class="token punctuation">)</span>
choro4<span class="token operator">$</span>set_zoom<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token string">"minnesota"</span><span class="token punctuation">,</span><span class="token string">"wisconsin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
choro4<span class="token operator">$</span>title <span class="token operator">=</span> <span class="token string">"Jill Stein"</span>
choro4<span class="token operator">$</span>set_num_colors<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
choro4<span class="token operator">$</span>ggplot_polygon <span class="token operator">=</span> geom_polygon<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>fill <span class="token operator">=</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
choro4<span class="token operator">$</span>ggplot_scale <span class="token operator">=</span> scale_fill_gradientn<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Percent"</span><span class="token punctuation">,</span>
                                           colours <span class="token operator">=</span> brewer.pal<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"Greens"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

grid.arrange<span class="token punctuation">(</span>choro1<span class="token operator">$</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> theme<span class="token punctuation">(</span>text<span class="token operator">=</span>element_text<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             choro2<span class="token operator">$</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> theme<span class="token punctuation">(</span>text<span class="token operator">=</span>element_text<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             choro3<span class="token operator">$</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> theme<span class="token punctuation">(</span>text<span class="token operator">=</span>element_text<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             choro4<span class="token operator">$</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> theme<span class="token punctuation">(</span>text<span class="token operator">=</span>element_text<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></code>`)}</pre> <div><img src="/img/WisconsinandMinnesotaPresidentialElectionResultsbyCounty-1.png" title="plot of chunk Wisconsin and Minnesota Presidential Election Results by County" alt="plot of chunk Wisconsin and Minnesota Presidential Election Results by County" style="display: block; margin: auto;"/></div> <p>Mapping the allocation of votes by county shows Wisconsin and Minnesota have very similar county-level maps. Each has strong results favoring Clinton in major metropolitan areas, including Milwaukee, Madison, and Minneapolis/St Paul. Based solely on each state’s map, I’d posit that Minnesota seems the more likely Trump-majority. This perspective is deceiving though, as the distribution of votes by county is skewed. Each map displays the percent of votes for each candidate by county, neglecting the county’s total votes. More than 78 percent of Menominee County, WI voters selected Hilary Clinton, resulting in Northeastern Wisconsin’s dark blue polygon, but totaled only 1279 votes.</p> <p>Lets break this down further by exploring the allocation of votes by county.</p> <h3>Vote Distributions by County</h3> <p>Focusing on the two major candidates, the two states also have similar vote distributions. Each of these figures displays the percentage of votes for Donald Trump (red) and Hilary Clinton (blue), with each bubble sized by percentage of total state vote, organized by the percentage of votes for Donald Trump.</p> <pre class="language-r">${html(`<code class="language-r">minnesota <span class="token operator">&lt;-</span> subset<span class="token punctuation">(</span>minnesotawisconsin<span class="token punctuation">,</span> st<span class="token operator">==</span><span class="token string">"MN"</span><span class="token punctuation">)</span>
minnesota<span class="token operator">$</span>votePct <span class="token operator">&lt;-</span> <span class="token punctuation">(</span>minnesota<span class="token operator">$</span>votes<span class="token operator">/</span>sum<span class="token punctuation">(</span>minnesota<span class="token operator">$</span>votes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>
minnesota <span class="token operator">&lt;-</span> minnesota <span class="token percent-operator operator">%>%</span> arrange<span class="token punctuation">(</span>desc<span class="token punctuation">(</span>votes<span class="token punctuation">)</span><span class="token punctuation">)</span>
vals <span class="token operator">=</span> minnesota<span class="token punctuation">[</span> minnesota<span class="token operator">$</span>cand <span class="token operator">==</span> <span class="token string">'Donald Trump'</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
minnesota<span class="token operator">$</span>county <span class="token operator">&lt;-</span> factor<span class="token punctuation">(</span>minnesota<span class="token operator">$</span>county<span class="token punctuation">,</span> levels <span class="token operator">=</span> rev<span class="token punctuation">(</span>vals<span class="token operator">$</span>county<span class="token punctuation">)</span><span class="token punctuation">)</span>
minnesotaSubset <span class="token operator">&lt;-</span> subset<span class="token punctuation">(</span>minnesota<span class="token punctuation">,</span> cand <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">"Donald Trump"</span><span class="token punctuation">,</span> <span class="token string">"Hillary Clinton"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
mnScatter <span class="token operator">&lt;-</span> ggplot<span class="token punctuation">(</span>minnesotaSubset<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>county<span class="token punctuation">,</span> votePct<span class="token punctuation">,</span>color <span class="token operator">=</span> cand<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_point<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>size <span class="token operator">=</span> votes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  scale_y_continuous<span class="token punctuation">(</span>limits<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme_tufte<span class="token punctuation">(</span>base_family <span class="token operator">=</span> <span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  scale_color_manual<span class="token punctuation">(</span>values <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"red3"</span><span class="token punctuation">,</span> <span class="token string">"navyblue"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  scale_size_continuous<span class="token punctuation">(</span>guide <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  labs<span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">"Percentage of Total Votes Cast for Clinton and Trump By County"</span><span class="token punctuation">,</span>
       subtitle <span class="token operator">=</span> <span class="token string">"Minnesota"</span><span class="token punctuation">,</span>
       y <span class="token operator">=</span> <span class="token string">"Total Vote Percentage"</span><span class="token punctuation">,</span>
       x <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme<span class="token punctuation">(</span>axis.text.x<span class="token operator">=</span>element_blank<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        axis.ticks.x<span class="token operator">=</span>element_blank<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        legend.title <span class="token operator">=</span> element_blank<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        plot.title <span class="token operator">=</span>  element_text<span class="token punctuation">(</span>size <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        plot.subtitle <span class="token operator">=</span>  element_text<span class="token punctuation">(</span>size <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

wisconsin<span class="token operator">$</span>votePct <span class="token operator">&lt;-</span> <span class="token punctuation">(</span>wisconsin<span class="token operator">$</span>votes<span class="token operator">/</span>sum<span class="token punctuation">(</span>wisconsin<span class="token operator">$</span>votes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>
wisconsin <span class="token operator">&lt;-</span> wisconsin <span class="token percent-operator operator">%>%</span> arrange<span class="token punctuation">(</span>desc<span class="token punctuation">(</span>votes<span class="token punctuation">)</span><span class="token punctuation">)</span>
vals <span class="token operator">=</span> wisconsin<span class="token punctuation">[</span> wisconsin<span class="token operator">$</span>cand <span class="token operator">==</span> <span class="token string">'Donald Trump'</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
wisconsin<span class="token operator">$</span>county <span class="token operator">&lt;-</span> factor<span class="token punctuation">(</span>wisconsin<span class="token operator">$</span>county<span class="token punctuation">,</span> levels <span class="token operator">=</span> rev<span class="token punctuation">(</span>vals<span class="token operator">$</span>county<span class="token punctuation">)</span><span class="token punctuation">)</span>
wisconsinSubset <span class="token operator">&lt;-</span> subset<span class="token punctuation">(</span>wisconsin<span class="token punctuation">,</span> cand <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">"Donald Trump"</span><span class="token punctuation">,</span> <span class="token string">"Hillary Clinton"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
wiScatter <span class="token operator">&lt;-</span> ggplot<span class="token punctuation">(</span>wisconsinSubset<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>county<span class="token punctuation">,</span> votePct<span class="token punctuation">,</span>color <span class="token operator">=</span> cand<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_point<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>size <span class="token operator">=</span> votes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  scale_y_continuous<span class="token punctuation">(</span>limits<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme_tufte<span class="token punctuation">(</span>base_family <span class="token operator">=</span> <span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  scale_color_manual<span class="token punctuation">(</span>values <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"red3"</span><span class="token punctuation">,</span> <span class="token string">"navyblue"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  scale_size_continuous<span class="token punctuation">(</span>guide <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  labs<span class="token punctuation">(</span>subtitle <span class="token operator">=</span> <span class="token string">"Wisconsin"</span><span class="token punctuation">,</span>
       y <span class="token operator">=</span> <span class="token string">"Total Vote Percentage"</span><span class="token punctuation">,</span>
       x <span class="token operator">=</span> <span class="token string">"County (ordered by Total Vote Percentage&#92;n for Donald Trump (smallest to largest))"</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme<span class="token punctuation">(</span>axis.text.x<span class="token operator">=</span>element_blank<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        axis.ticks.x<span class="token operator">=</span>element_blank<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        legend.title <span class="token operator">=</span> element_blank<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        plot.title <span class="token operator">=</span> element_text<span class="token punctuation">(</span>size <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        plot.subtitle <span class="token operator">=</span> element_text<span class="token punctuation">(</span>size <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

grid.arrange<span class="token punctuation">(</span>mnScatter<span class="token punctuation">,</span>wiScatter<span class="token punctuation">,</span>ncol<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></code>`)}</pre> <div><img src="/img/scatterPlotting-1.png" title="plot of chunk scatter plotting" alt="plot of chunk scatter plotting" style="display: block; margin: auto;"/></div> <p>Two things of note from these figures:</p> <ul><li>The county with Minnesota’s most votes significantly backed Clinton over Trump (14.7% and 6.6% of the total votes cast in the state respectively). Meanwhile, the top-voting Wisconsin’s county also garnered significant support for Clinton over Trump, but contributed only 9.8% and 4.3% of the total votes cast in the state respectively.</li> <li>Trump earned more votes than Clinton in 7 of Wisconsin’s 10 largest counties, including Waukesha - the third largest (4.9% and 2.7% of the total votes cast in the state respectively). Only 4 out of the top 10 most populous counties in Minnesota favored Trump.</li></ul> <p>The above figure seems to imply that the counties with larger populations in each state had a significant impact on each state’s victor; while most Wisconsin counties favored Trump, most Minnesota counties favored Clinton. Perhaps different levels of urban density might result in a better explanation?</p> <p>The 2010 Census <a href="https://www.whitehouse.gov/sites/default/files/omb/assets/fedreg_2010/06282010_metro_standards-Complete.pdf" rel="nofollow">breaks up metropolitan areas</a> into segments: small, medium, and large. An area must have a population of at least 50,000 to be considered an urbanized metropolitan area, and is further separated if it’s population is greater than 250,000. For this analysis, small metropolitan areas consist of those ranging in population from 50,000 to 250,000, while populations greater than 250,000 are combined into one category.</p> <pre class="language-r">${html(`<code class="language-r">minnesotawisconsin <span class="token operator">&lt;-</span> all_results <span class="token percent-operator operator">%>%</span>
  filter<span class="token punctuation">(</span>str_detect<span class="token punctuation">(</span>fips<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"^55"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> str_detect<span class="token punctuation">(</span>fips<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">"^27"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

minnesotawisconsin<span class="token operator">$</span>urbanClass <span class="token operator">&lt;-</span> ifelse<span class="token punctuation">(</span>minnesotawisconsin<span class="token operator">$</span>POP_COU <span class="token operator">&lt;</span> <span class="token number">50000</span><span class="token punctuation">,</span> <span class="token string">"Not a Metropolitan Area"</span><span class="token punctuation">,</span>
                                 ifelse<span class="token punctuation">(</span>minnesotawisconsin<span class="token operator">$</span>POP_COU <span class="token operator">></span> <span class="token number">50000</span> <span class="token operator">&amp;</span> minnesotawisconsin<span class="token operator">$</span>POP_COU <span class="token operator">&lt;</span> <span class="token number">250000</span><span class="token punctuation">,</span>
                                        <span class="token string">"Small Metropolitan Area"</span><span class="token punctuation">,</span><span class="token string">"Medium to Large Metropolitan Area"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># Quick idiot check to make sure our ifelse statement didn't go awry</span>
table<span class="token punctuation">(</span>round<span class="token punctuation">(</span>minnesotawisconsin<span class="token operator">$</span>POP_COU<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> minnesotawisconsin<span class="token operator">$</span>urbanClass<span class="token punctuation">)</span></code>`)}</pre> <pre class="language-r">${html(`<code class="language-r"><span class="token comment">##</span>
<span class="token comment">##           Medium to Large Metropolitan Area Not a Metropolitan Area Small Metropolitan Area</span>
<span class="token comment">##   0                                       0                     920                       0</span>
<span class="token comment">##   1e+05                                   0                       0                     241</span>
<span class="token comment">##   2e+05                                   0                       0                      69</span>
<span class="token comment">##   3e+05                                   9                       0                       0</span>
<span class="token comment">##   4e+05                                  16                       0                       0</span>
<span class="token comment">##   5e+05                                  16                       0                       0</span>
<span class="token comment">##   9e+05                                   7                       0                       0</span>
<span class="token comment">##   1200000                                 9                       0                       0</span></code>`)}</pre> <p>After a quick <code>table</code> to ensure correct recoding of urban classification, I grouped the data by candidate, state, and urban classification to better isolate the voting distributions.</p> <pre class="language-r">${html(`<code class="language-r">minnesotawisconsin<span class="token operator">$</span>urbanClass <span class="token operator">&lt;-</span> factor<span class="token punctuation">(</span>minnesotawisconsin<span class="token operator">$</span>urbanClass<span class="token punctuation">,</span>
                                        levels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Medium to Large Metropolitan Area"</span><span class="token punctuation">,</span> <span class="token string">"Small Metropolitan Area"</span><span class="token punctuation">,</span> <span class="token string">"Not a Metropolitan Area"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

mnwiUrban <span class="token operator">&lt;-</span> minnesotawisconsin <span class="token percent-operator operator">%>%</span>
  filter<span class="token punctuation">(</span>cand <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">"Donald Trump"</span><span class="token punctuation">,</span> <span class="token string">"Hillary Clinton"</span><span class="token punctuation">,</span> <span class="token string">"Gary Johnson"</span><span class="token punctuation">,</span> <span class="token string">"Jill Stein"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  mutate<span class="token punctuation">(</span>cand <span class="token operator">=</span> factor<span class="token punctuation">(</span>cand<span class="token punctuation">,</span> levels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Donald Trump"</span><span class="token punctuation">,</span> <span class="token string">"Hillary Clinton"</span><span class="token punctuation">,</span> <span class="token string">"Gary Johnson"</span><span class="token punctuation">,</span> <span class="token string">"Jill Stein"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                       labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Trump"</span><span class="token punctuation">,</span> <span class="token string">"Clinton"</span><span class="token punctuation">,</span> <span class="token string">"Johnson"</span><span class="token punctuation">,</span> <span class="token string">"Stein"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  group_by<span class="token punctuation">(</span>cand<span class="token punctuation">,</span> st<span class="token punctuation">,</span>urbanClass<span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  summarise<span class="token punctuation">(</span>sumVotes <span class="token operator">=</span> sum<span class="token punctuation">(</span>votes<span class="token punctuation">)</span><span class="token punctuation">,</span> population <span class="token operator">=</span> sum<span class="token punctuation">(</span>POP_COU<span class="token punctuation">)</span><span class="token punctuation">)</span>

mnwiUrban <span class="token operator">&lt;-</span> mnwiUrban <span class="token percent-operator operator">%>%</span>
  group_by<span class="token punctuation">(</span>st<span class="token punctuation">,</span> urbanClass<span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
  mutate<span class="token punctuation">(</span>percent <span class="token operator">=</span> sumVotes<span class="token operator">/</span>sum<span class="token punctuation">(</span>sumVotes<span class="token punctuation">)</span><span class="token punctuation">)</span>

mnwiUrban<span class="token operator">$</span>st <span class="token operator">&lt;-</span> factor<span class="token punctuation">(</span>mnwiUrban<span class="token operator">$</span>st<span class="token punctuation">,</span> levels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"MN"</span><span class="token punctuation">,</span> <span class="token string">"WI"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Minnesota"</span><span class="token punctuation">,</span> <span class="token string">"Wisconsin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

p <span class="token operator">&lt;-</span> ggplot<span class="token punctuation">(</span>mnwiUrban<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>cand<span class="token punctuation">,</span> sumVotes<span class="token punctuation">,</span>fill <span class="token operator">=</span> cand<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token operator">+</span>
  geom_bar<span class="token punctuation">(</span>stat <span class="token operator">=</span> <span class="token string">"identity"</span><span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  facet_grid<span class="token punctuation">(</span>st <span class="token operator">~</span> urbanClass<span class="token punctuation">)</span> <span class="token operator">+</span>
  theme_tufte<span class="token punctuation">(</span>base_family <span class="token operator">=</span> <span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  scale_fill_manual<span class="token punctuation">(</span>values <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"red3"</span><span class="token punctuation">,</span> <span class="token string">"navyblue"</span><span class="token punctuation">,</span> <span class="token string">"#6A51A3"</span><span class="token punctuation">,</span><span class="token string">"darkgreen"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme<span class="token punctuation">(</span>legend.position<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">,</span>
        strip.text.x <span class="token operator">=</span> element_text<span class="token punctuation">(</span>size <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        strip.text.y <span class="token operator">=</span> element_text<span class="token punctuation">(</span>size <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        plot.title <span class="token operator">=</span>  element_text<span class="token punctuation">(</span>size <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_text<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>label<span class="token operator">=</span>paste0<span class="token punctuation">(</span>round<span class="token punctuation">(</span>percent<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token string">"%"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nudge_y <span class="token operator">=</span> <span class="token number">50000</span><span class="token punctuation">,</span>family <span class="token operator">=</span> <span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  labs<span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">"Distribution of Votes Cast in Minnesota and Wisconsin Counties By Urban Classification"</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">"Number of votes"</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  scale_y_continuous<span class="token punctuation">(</span>limits<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Add in some annotations - since we're facetting we need to make a dummy data.frame with the same factor levels and plot positions as those used in the figure</span>
anns <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>cand <span class="token operator">=</span> factor<span class="token punctuation">(</span><span class="token string">"Gary Johnson"</span><span class="token punctuation">,</span> levels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Donald Trump"</span><span class="token punctuation">,</span> <span class="token string">"Hillary Clinton"</span><span class="token punctuation">,</span> <span class="token string">"Gary Johnson"</span><span class="token punctuation">,</span> <span class="token string">"Jill Stein"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                 labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Trump"</span><span class="token punctuation">,</span> <span class="token string">"Clinton"</span><span class="token punctuation">,</span> <span class="token string">"Johnson"</span><span class="token punctuation">,</span> <span class="token string">"Stein"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   st <span class="token operator">=</span> factor<span class="token punctuation">(</span><span class="token string">"MN"</span><span class="token punctuation">,</span> levels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"MN"</span><span class="token punctuation">,</span> <span class="token string">"WI"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Minnesota"</span><span class="token punctuation">,</span> <span class="token string">"Wisconsin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   sumVotes <span class="token operator">=</span> <span class="token number">700000</span><span class="token punctuation">,</span>
                   lab <span class="token operator">=</span> <span class="token string">"For each State and Urban Class:&#92;nBar Height - Total Votes&#92;n&#92;n  Percent - Portion of votes"</span><span class="token punctuation">,</span>
                   urbanClass <span class="token operator">=</span> factor<span class="token punctuation">(</span><span class="token string">"Not a Metropolitan Area"</span><span class="token punctuation">,</span>levels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Medium to Large Metropolitan Area"</span><span class="token punctuation">,</span>
                                                                            <span class="token string">"Small Metropolitan Area"</span><span class="token punctuation">,</span> <span class="token string">"Not a Metropolitan Area"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## Apply the annotations to the top right facet (i.e. Minnesota, Not a Metropolitan Area). Swoopy arrows are fun!</span>
p <span class="token operator">+</span> geom_text<span class="token punctuation">(</span>data <span class="token operator">=</span> anns<span class="token punctuation">,</span>aes<span class="token punctuation">(</span>label <span class="token operator">=</span>lab<span class="token punctuation">)</span><span class="token punctuation">,</span> family <span class="token operator">=</span> <span class="token string">"DejaVu Sans Mono"</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_curve<span class="token punctuation">(</span>data<span class="token operator">=</span>anns<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">2.1</span><span class="token punctuation">,</span> xend<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">690000</span><span class="token punctuation">,</span> yend<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> curvature<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> arrow<span class="token operator">=</span>arrow<span class="token punctuation">(</span>length<span class="token operator">=</span>unit<span class="token punctuation">(</span><span class="token number">0.03</span><span class="token punctuation">,</span> <span class="token string">"npc"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_curve<span class="token punctuation">(</span>data<span class="token operator">=</span>anns<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">2.4</span><span class="token punctuation">,</span> xend<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">580000</span><span class="token punctuation">,</span> yend<span class="token operator">=</span><span class="token number">110000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> curvature<span class="token operator">=</span><span class="token operator">-</span><span class="token number">0.3</span><span class="token punctuation">,</span> arrow<span class="token operator">=</span>arrow<span class="token punctuation">(</span>length<span class="token operator">=</span>unit<span class="token punctuation">(</span><span class="token number">0.03</span><span class="token punctuation">,</span> <span class="token string">"npc"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code>`)}</pre> <div><img src="/img/PresidentialElectionResultsbyUrbanArea-1.png" title="plot of chunk Presidential Election Results by Urban Area" alt="plot of chunk Presidential Election Results by Urban Area" style="display: block; margin: auto;"/></div> <p>The data shows a sizable rural/urban divide in Minnesota <strong>and</strong> Wisconsin. Both states voted for each candidate at nearly the exact same rate in medium/large and small metropolitan areas. The major difference is how the population in each state is distributed:</p> <pre class="language-r">${html(`<code class="language-r">mnwiUrban <span class="token percent-operator operator">%>%</span>
    select<span class="token punctuation">(</span>st<span class="token punctuation">,</span>urbanClass<span class="token punctuation">,</span> sumVotes<span class="token punctuation">,</span> population<span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
    group_by<span class="token punctuation">(</span>st<span class="token punctuation">,</span>urbanClass<span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
    summarise<span class="token punctuation">(</span>total <span class="token operator">=</span> sum<span class="token punctuation">(</span>sumVotes<span class="token punctuation">)</span><span class="token punctuation">,</span> metroPopulationTotal <span class="token operator">=</span> unique<span class="token punctuation">(</span>population<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%>%</span>
    mutate<span class="token punctuation">(</span>stateVoteAllocationByMetro <span class="token operator">=</span> total<span class="token operator">/</span>sum<span class="token punctuation">(</span>total<span class="token punctuation">)</span><span class="token punctuation">,</span>
           populationPctByMetro <span class="token operator">=</span> metroPopulationTotal<span class="token operator">/</span>sum<span class="token punctuation">(</span>metroPopulationTotal<span class="token punctuation">)</span><span class="token punctuation">,</span>
           votingPctByMetro <span class="token operator">=</span> total<span class="token operator">/</span>metroPopulationTotal<span class="token punctuation">)</span></code>`)}</pre> <pre class="language-r">${html(`<code class="language-r"><span class="token comment">## Source: local data frame [6 x 7]</span>
<span class="token comment">## Groups: st [2]</span>
<span class="token comment">##</span>
<span class="token comment">##          st                        urbanClass   total metroPopulationTotal stateVoteAllocationByMetro populationPctByMetro votingPctByMetro</span>
<span class="token comment">##      &lt;fctr>                            &lt;fctr>   &lt;int>                &lt;dbl>                      &lt;dbl>                &lt;dbl>            &lt;dbl></span>
<span class="token comment">## 1 Minnesota Medium to Large Metropolitan Area 1318717              2390461                  0.4644240            0.4506966        0.5516580</span>
<span class="token comment">## 2 Minnesota           Small Metropolitan Area  854434              1579726                  0.3009134            0.2978409        0.5408748</span>
<span class="token comment">## 3 Minnesota           Not a Metropolitan Area  666317              1333738                  0.2346626            0.2514625        0.4995861</span>
<span class="token comment">## 4 Wisconsin Medium to Large Metropolitan Area  972116              1825699                  0.3318823            0.3210310        0.5324624</span>
<span class="token comment">## 5 Wisconsin           Small Metropolitan Area 1411946              2766790                  0.4820411            0.4865125        0.5103192</span>
<span class="token comment">## 6 Wisconsin           Not a Metropolitan Area  545037              1094497                  0.1860767            0.1924564        0.4979794</span></code>`)}</pre> <p>While the highest portion of votes in Minnesota came from counties defined as medium and large metropolitan areas (46.4%), those defined as small metropolitan areas contributed the most votes in Wisconsin (48.2%). These voting distributions match up nicely with the percentage of each state’s population by metropolitan area, as seen in the two variables <code>stateVoteAllocationByMetro</code> and <code>populationPctByMetro</code> - these distributions contributed to the outcome of each state’s election. The rate at which different types of urban areas supported a particular candidate is nearly identical between Minnesota and Wisconsin.</p> <h4>Conclusion</h4> <p>While there are major differences in how rural and urban voters supported particular candidates, this division is not unique to states that cracked the “Midwestern Blue-State Firewall” in the 2016 presidential election. In Minnesota and Wisconsin, larger metropolitan areas voted strongly in favor of Clinton, while smaller and non-urban areas strongly favored Trump. Further exploration is necessary to make more granular conclusions, but in these two states the differing distributions of populations into small and medium/large metropolitan areas may help explain each candidate’s victory.</p> <h4>Next Steps</h4> <p>Data with eligible-voter populations and demographic information at the county level might further supplement this exploration by providing a more detailed picture of rural and urban voters beyond raw population and vote totals. Outlets such as <a href="http://fivethirtyeight.com/features/why-fivethirtyeight-gave-trump-a-better-chance-than-almost-anyone-else/" rel="nofollow">FiveThirtyEight</a> have used this type of granular data to inform predictive forecasts of elections. Thoughts or questions about the post? Contact me on <a href="https://twitter.com/mikeleeco" rel="nofollow">twitter</a>.</p>`;
}
export {
  _016_12_26_wisconsin_presidential_election_results_md as default,
  metadata
};
